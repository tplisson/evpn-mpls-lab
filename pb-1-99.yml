---
  - name: Create Directories
    hosts: localhost
    gather_facts: no

    tasks:

    - name: Create directories      
      vars:
        test_dir: "testcase/1.99"
        detailed_dir: "testcase/1.99/detailed"
      file: 
        path: "{{playbook_dir}}/{{item}}" 
        state: directory
      with_items:
        - "{{test_dir}}"
        - "{{detailed_dir}}"

  - name: "{{testcase}}"
    hosts: DC1
    roles:
     - Juniper.junos
    connection: local
    gather_facts: no
    vars:
      testcase: "Test Case 1-1: IGP ISIS routing"
      test_dir: "testcase/1.99"
      detailed_dir: "testcase/1.99/detailed"
      credentials:
        host: "{{ inventory_hostname }}"
        user: "{{ ansible_ssh_user }}"
        passwd: "{{ ansible_ssh_pass }}"
  
    tasks:

    #- name: Checking NETCONF connectivity
    #  wait_for: 
    #    host: "{{ inventory_hostname }}"
    #    port: "{{ ansible_port }}"
    #    timeout: 2
    #  register: netconf_result

    - name: Gathering regular output for {{testcase}}
      #when: netconf_result|success
      juniper_junos_command:
        command:
          - "show route 10.35.1.1 exact"
          - 'show route 10.35.1.1 exact extensive'
          - 'show route 10.35.1.2 exact'
          - 'show route 10.35.1.3 exact'
          - 'show route 10.35.1.4 exact'
          - 'show route 10.35.2.1 exact'
          - 'show route 10.35.2.2 exact'
          - 'show route 10.35.2.3 exact'
          - 'show route 10.35.2.4 exact'
        dest_dir: "{{playbook_dir}}/{{test_dir}}/"
        return_output: false

    - name: Gathering regular output for {{testcase}}
      #when: netconf_result|success
      juniper_junos_table:
        file: "routes.yml"
        table: "RouteTable"
        kwargs:
          destination: "10.35.0.0/16"
        response_type: "juniper_items"
      register: response

    - name: Print response
      debug:
        var: response
